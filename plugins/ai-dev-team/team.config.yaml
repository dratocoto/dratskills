# ============================================================================
# AI Dev Team — Cấu hình trung tâm
# ============================================================================
# Nguồn duy nhất cho toàn bộ cấu hình agent.
# Các file agent .md tham chiếu đến file này thay vì nhúng config trong nội dung.
#
# Hệ thống cấu hình hai cấp:
#   1. team.config.yaml (file này) → định nghĩa agent, danh mục skill, workflow
#   2. .ai-workspace/stack.config.yaml (theo dự án) → ánh xạ danh mục sang skill cụ thể
#
# Để thay đổi skill mà agent tải: sửa danh sách `skills` bên dưới.
# Để thay đổi skill thực tế cho một danh mục: sửa stack.config.yaml.
# ============================================================================

version: "0.5.1"

# ─────────────────────────────────────────────────────────────────────────────
# Danh mục Skill
# ─────────────────────────────────────────────────────────────────────────────
# Định nghĩa các danh mục skill khả dụng.
# Tên skill thực tế được ánh xạ theo dự án trong .ai-workspace/stack.config.yaml
# Giá trị đặc biệt trong stack config: _none_ → agent bỏ qua danh mục đó.

skill_categories:
  backend-patterns: "Các mẫu thiết kế backend theo framework (FastAPI, Django, Express)"
  frontend-guide: "Các mẫu thiết kế frontend theo framework (Next.js, React, Vue)"
  language: "Tính năng đặc thù của ngôn ngữ (Python 3.12, TypeScript)"
  conventions: "Quy chuẩn và quy tắc coding cho tất cả agent"

# ─────────────────────────────────────────────────────────────────────────────
# Cài đặt Workflow
# ─────────────────────────────────────────────────────────────────────────────

workflow:
  workspace_dir: ".ai-workspace"
  max_discussion_rounds: 3
  max_review_rounds: 3
  prefixes:
    feature: "FEAT"
    task: "TASK"
    discussion: "DISC"
    research: "RESEARCH"

# ─────────────────────────────────────────────────────────────────────────────
# Định nghĩa Agent
# ─────────────────────────────────────────────────────────────────────────────
# Cấu hình đầy đủ của từng agent. File agent .md cần đồng bộ các trường
# name/description/model/color/tools trong YAML frontmatter (yêu cầu bởi
# hệ thống plugin), còn các config khác (skills, context) chỉ nằm ở đây.

agents:
  # ── PM ─────────────────────────────────────────────────────────────────────
  pm-agent:
    role: "Project Manager"
    model: inherit
    color: cyan
    tools:
      - Read
      - Write
      - Edit
      - Glob
      - Grep
      - "Bash(ls:*)"
      - "Bash(tree:*)"
      - "Bash(mkdir:*)"
      - "Bash(git:*)"
    skills: [] # PM không tải skill kỹ thuật
    context:
      max_files: 4
      always_read:
        - ".ai-workspace/STATE.md"
        - ".ai-workspace/stack.config.yaml"

  # ── BA ─────────────────────────────────────────────────────────────────────
  ba-agent:
    role: "Business Analyst"
    model: inherit
    color: magenta
    tools:
      - Read
      - Write
      - Edit
      - Glob
      - Grep
      - "Bash(ls:*)"
      - "Bash(tree:*)"
    skills:
      - conventions # Để nắm bối cảnh — giúp đặt câu hỏi kỹ thuật chính xác hơn
    context:
      max_files: 5
      always_read:
        - ".ai-workspace/STATE.md"
        - ".ai-workspace/stack.config.yaml"

  # ── Architect ──────────────────────────────────────────────────────────────
  architect-agent:
    role: "Software Architect"
    model: inherit
    color: blue
    tools:
      - Read
      - Write
      - Edit
      - Glob
      - Grep
      - "Bash(ls:*)"
      - "Bash(tree:*)"
    skills:
      - backend-patterns
      - frontend-guide
      - conventions
    context:
      max_files: 5

  # ── Backend Dev ────────────────────────────────────────────────────────────
  backend-dev-agent:
    role: "Backend Developer"
    model: inherit
    color: green
    tools:
      - Read
      - Write
      - Edit
      - Grep
      - Glob
      - "Bash(python3:*)"
      - "Bash(ruff:*)"
      - "Bash(mypy:*)"
      - "Bash(npm:*)"
      - "Bash(npx:*)"
      - "Bash(uv:*)"
      - "Bash(ls:*)"
      - "Bash(tree:*)"
    skills:
      - backend-patterns
      - language
      - conventions
    context:
      max_files: 5

  # ── Frontend Dev ───────────────────────────────────────────────────────────
  frontend-dev-agent:
    role: "Frontend Developer"
    model: inherit
    color: bright_cyan
    tools:
      - Read
      - Write
      - Edit
      - Grep
      - Glob
      - "Bash(npm:*)"
      - "Bash(npx:*)"
      - "Bash(node:*)"
      - "Bash(ls:*)"
      - "Bash(tree:*)"
    skills:
      - frontend-guide
      - conventions
    context:
      max_files: 5

  # ── Reviewer ───────────────────────────────────────────────────────────────
  reviewer-agent:
    role: "Senior Reviewer"
    model: inherit
    color: white
    tools:
      - Read
      - Write
      - Edit
      - Glob
      - Grep
      - "Bash(ls:*)"
      - "Bash(tree:*)"
      - "Bash(ruff:*)"
      - "Bash(mypy:*)"
      - "Bash(npx:*)"
    skills:
      - backend-patterns
      - frontend-guide
      - language
      - conventions
    context:
      max_files: 5
      note: "Chỉ tải skill liên quan đến phần code đang review"

  # ── Tester ─────────────────────────────────────────────────────────────────
  test-agent:
    role: "Test Engineer"
    model: inherit
    color: yellow
    tools:
      - Read
      - Write
      - Edit
      - Grep
      - Glob
      - "Bash(ls:*)"
      - "Bash(tree:*)"
      - "Bash(pytest:*)"
      - "Bash(python3:*)"
      - "Bash(npm:*)"
      - "Bash(npx:*)"
    skills:
      - language
      - backend-patterns
      - frontend-guide
      - conventions
    context:
      max_files: 5
      note: "Chỉ tập trung vào stack liên quan"

  # ── QA ─────────────────────────────────────────────────────────────────────
  qa-agent:
    role: "QA Engineer"
    model: inherit
    color: red
    tools:
      - Read
      - Write
      - Edit
      - Grep
      - Glob
      - "Bash(ruff:*)"
      - "Bash(mypy:*)"
      - "Bash(pytest:*)"
      - "Bash(npx:*)"
      - "Bash(tree:*)"
    skills:
      - backend-patterns
      - frontend-guide
      - conventions
    context:
      max_files: 7

  # ── Researcher ─────────────────────────────────────────────────────────────
  researcher-agent:
    role: "Researcher"
    model: inherit
    color: gray
    tools:
      - Read
      - Grep
      - Glob
      - "Bash(ls:*)"
      - "Bash(tree:*)"
      - WebSearch
      - WebFetch
    skills:
      - backend-patterns # Để nắm bối cảnh — biết stack đang sử dụng
      - frontend-guide # Để nắm bối cảnh
      - language # Để nắm bối cảnh
    context:
      max_files: 7
